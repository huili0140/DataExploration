---
title: "The Working Moms"
output:
  html_document:
    theme: cerulean
---
_________________________________________________________________________________________________

# Introduction

The 2013 American Community Survey run by the US Census Bureau provides a rich dataset with detailed information of approximately 3.5 million households regarding to topics such as ancestry, education, employment, and residency. Being a working mom myself, I'm particularly interested in a descriptive analysis of the employment status of the American moms with dependent children younger than 18 years old.

### Dataset

The variables including information of region, age, marital status, presence of kids, employment status, education, and wage were read into R and saved as pus.Rdata. Male and Female less than 16 years old were removed from the dataset by omitting the instances with NA in the PAOC variable.  

```{r echo=TRUE, message=FALSE, warning=FALSE}
#library(data.table)
#cols <- c("PAOC", "ST", "AGEP", "MAR", "ESR", "COW", "SCHL", "WAGP")
#pusa <- fread("ss13pusa.csv", select = cols)
#pusb <- fread("ss13pusb.csv", select = cols)
#pus <- subset(rbind(pusa, pusb), !is.na(PAOC))
#save(pus, file = "pus.Rdata")
```

The variables were labled as factor variables according to ACS data dictionary. The instances were classified into four groups including moms with little kids ("children under 6"), moms with old kids ("children 6 to 17"), moms with little kids and old kids ("children under 6 and 6 to 17"), and women without kids ("no children") according to the information of presence of children (PAOC). 

```{r echo=TRUE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
load("pus.Rdata")

pus$MAR <- factor(pus$MAR)
levels(pus$MAR) <- c("Married", "Widowed", "Divorced", "Separated", "Never married")

pus$ESR <- factor(pus$ESR)
levels(pus$ESR) <- c("Employed", "Employed, not at work", "Unemployed", "Employed", "Employed, not at work", "Not in labor force")
pus$ESRG <- ifelse(pus$ESR == "Employed", 1, 0)

pus$COW <- factor(pus$COW)
levels(pus$COW) <- c("Private profit", "Private non-profit", "Local government", "State government", "Federal government", "Self-employed", "Self-employed", "Working without pay", "Unemployed")

pus$PAOC <- factor(pus$PAOC)
levels(pus$PAOC) <- c("Children under 6", "Children 6 to 17", "Children under 6 and 6 to 17", "No children")
pus$PAOCG <- ifelse(pus$PAOC == "No children", 0, 1)

pus$SCHL <- ifelse(pus$SCHL <= 16, 16, pus$SCHL)
pus$SCHL <- ifelse(pus$SCHL >= 17 & pus$SCHL <= 19, 19, pus$SCHL)
pus$SCHL <- factor(pus$SCHL)
levels(pus$SCHL) <- c("High school or lower", "Some college", "Associate's degree", "Bachelor's degree", "Master's degree", "Professional degree", "Doctorate degree")

am <- subset(pus, PAOCG == 1)
```

# Overview of the American Moms

### Age

```{r echo=TRUE, message=FALSE, warning=FALSE}
ggplot(pus, aes(AGEP, group = PAOC)) + 
  geom_bar(binwidth = 1, aes(colour = PAOC, fill = PAOC), alpha = 0.3) +
  xlab("Age") + 
  ylab("Count") + 
  ggtitle("Women by Age")

prop.table(table(pus$PAOC))
by(pus$AGEP, pus$PAOCG, summary)
```

### Observation

Being a mom with dependent children is a transient stage in a women's life. Roughly a quarter of the women older than 16 were with dependent children, and only 5.8% of them were with little kids younger than 6 years old. The age distribution of the moms was bell-shaped with a median value of 38 and interquantile range of 13. The median ages of moms with little kids, moms with big kids, and moms with both were 30, 43, and 34 respectively. 

### Marital Status

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$AGEP, am$MAR)))
data$margin <- prop.table(table(am$AGEP))
data$height <- data$Freq/data$margin
data$center <- c(0, cumsum(data$margin)[1:length(levels(factor(am$AGEP))) -1]) + data$margin/2
ggplot(data, aes(center, height)) + 
  geom_bar(stat = "identity", aes(width = margin, fill = Var2), col = "gray", alpha = 0.7) +
  xlab("Age") +
  ylab("Marital Status") + 
  ggtitle("Marital Status of the Moms")
```

### Observation

Roughly three quarters of the moms with dependent children were married, and the proportion of the married moms remained relatively constant given the various ages of their children. The single moms with little kids were more likely to be never married, While the single moms with big kids were more likely to be divorced or separated.

### Employment Status

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$AGEP, am$ESR)))
data$margin <- prop.table(table(am$AGEP))
data$height <- data$Freq/data$margin
data$center <- c(0, cumsum(data$margin)[1:length(levels(factor(am$AGEP))) -1]) + data$margin/2
ggplot(data, aes(center, height)) + 
  geom_bar(stat = "identity", aes(width = margin, fill = Var2), col = "gray", alpha = 0.7) +
  xlab("Age") +
  ylab("Employment Status") + 
  ggtitle("Employment Status of the Moms")
```

### Observation

Approximately 60% of the moms with little kids were employed and actively at work, and the percentage of employment raised to 70% in the group of moms with big kids. The lowest rate of employment (56%) was found in the group of moms with both little and big kids. 

### Education Level

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$AGEP, am$SCHL)))
data$margin <- prop.table(table(am$AGEP))
data$height <- data$Freq/data$margin
data$center <- c(0, cumsum(data$margin)[1:length(levels(factor(am$AGEP))) -1]) + data$margin/2
ggplot(data, aes(center, height)) + 
  geom_bar(stat = "identity", aes(width = margin, fill = Var2), col = "gray", alpha = 0.7) +
  xlab("Age") +
  ylab("Education") + 
  ggtitle("Education Level of the Moms")
```

### Observation

The younger moms with little kids showed higher education level compared to the older moms with big kids. About 40% of the moms with little kids possessed a Bachelor's degree or higher, while the proportion was only 32-35% in the groups of moms with big kids.  

# Working Moms vs Stay-At-Home Moms

While it's most likely a personal choice to be a working mom or not, there might be objective factors that influence the mom's decision. 

### Age vs Employment Status

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$AGEP, am$ESR), margin = 1))
data$Var1 <- as.numeric(as.character(data$Var1))
ggplot(subset(data, Var1 <= 72), aes(x = Var1, y = Freq, group = Var2)) + 
  geom_bar(stat = "identity", aes(colour = Var2, fill = Var2), alpha = 0.3) + 
  xlab("Age") +
  ylab("Frequency") +
  ggtitle("Age vs Employment Status")
```

### Maritl Status vs Employment Status

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$MAR, am$ESR), margin = 1))
ggplot(data, aes(x = Var1, y = Freq, group = Var2)) + 
  geom_bar(stat = "identity", aes(colour = Var2, fill = Var2), alpha = 0.3) + 
  xlab("Marital Status") +
  ylab("Frequency") +
  ggtitle("Marital Status vs Employment Status")
```

### Education vs Employment Status

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$SCHL, am$ESR), margin = 1))
ggplot(data, aes(x = Var1, y = Freq, group = Var2)) + 
  geom_bar(stat = "identity", aes(colour = Var2, fill = Var2), alpha = 0.3) + 
  xlab("Education") +
  ylab("Frequency") +
  ggtitle("Education vs Employment Status")
```

### Type of Work

```{r echo=TRUE, message=FALSE, warning=FALSE}
data <- as.data.frame(prop.table(table(am$COW, am$ESR), margin = 2))
data <- subset(data, Var2 == "Employed" & Var1 != "Unemployed")
ggplot(data, aes(x = Var1, y = Freq, group = Var2)) + 
  geom_bar(stat = "identity", aes(colour = Var2, fill = Var2), alpha = 0.3) + 
  xlab("Type of Work") +
  ylab("Frequency") +
  ggtitle("Type of Work vs Employment Status")
```


### Inference:

working mom --- salarity levels
compare to working women without kids
by age
by education
by class of work

working mom's rate 
salary level

### Conclusion:

Insert conclusion here...

### References:

Insert references here...

### Appendix:

Insert appendix here...